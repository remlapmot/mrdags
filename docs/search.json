[
  {
    "objectID": "index.html#introduction",
    "href": "index.html#introduction",
    "title": "R, DOT, and TikZ code to plot directed acyclic graphs and single world intervention graphs for Mendelian randomization analyses",
    "section": "Introduction",
    "text": "Introduction\nThis webpage shows some R code for generating figures, directed acyclic graphs (DAGs), and single world intervention graphs (SWIGs) for Mendelian randomization (MR) analyses.\nFirst, we load in the tidyverse collection of packages to have access to the pipe and the ggplot2 package, amongst other features.\n\nlibrary(tidyverse)\n\nIf you do not already one you will need a LaTeX installation. In R it is easiest to install TinyTeX as follows.\n\ninstall.packages(\"tinytex\")\ntinytex::install_tinytex()"
  },
  {
    "objectID": "index.html#diagrammer-package",
    "href": "index.html#diagrammer-package",
    "title": "R, DOT, and TikZ code to plot directed acyclic graphs and single world intervention graphs for Mendelian randomization analyses",
    "section": "DiagrammeR package",
    "text": "DiagrammeR package\nThe website for DiagrammeR is here: http://rich-iannone.github.io/DiagrammeR/ .\nWe will draw the DAGs using Graphviz which uses the DOT language to describe graphs.\n\nSingle genotype DAG\n\nDiagrammeR::grViz(\"\n  digraph mrdag {\n\n  graph [rankdir=TB]\n\n  node [shape=ellipse]\n  U [label='Confounders']\n\n  node [shape=box, height=0.3, width=0.3]\n  G [label='Genotype']\n  X [label='Phenotype']\n  Y [label='Outcome']\n  { rank = same; G X Y }\n\n  G -&gt; X [minlen=3]\n  U -&gt; X\n  U -&gt; Y\n  X -&gt; Y [minlen=3]\n  }\n  \", height = 200)\n\n\n\n\n\n\nVersion without borders around observed variables\n\nDiagrammeR::grViz(\"\n  digraph mrdag {\n\n  graph [rankdir=TB]\n\n  node [shape=ellipse]\n  U [label='Confounders']\n\n  node [shape=plaintext, height=0.3, width=0.3]\n  G [label='Genotype']\n  X [label='Phenotype']\n  Y [label='Outcome']\n\n  { rank = same; G X Y }\n\n  G -&gt; X [minlen=3]\n  U -&gt; X\n  U -&gt; Y\n  X -&gt; Y [minlen=3]\n  }\n  \", height = 200)\n\n\n\n\n\n\n\n\nMultiple genotype DAG\n\nDiagrammeR::grViz(\"\n  digraph mrdag {\n\n  graph [rankdir=TB, layout=neato]\n\n  node [shape=ellipse]\n  U [label='Confounders', pos='3,1!']\n\n  node [shape=box, height=0.3, width=0.3]\n  G1 [label='&lt;I&gt;G@_{1}&lt;/I&gt;', pos='0,0.75!']\n  G2 [label='&lt;I&gt;G@_{2}&lt;/I&gt;', pos='0,0!']\n  G3 [label='&lt;I&gt;G@_{3}&lt;/I&gt;', pos='0,-0.75!']\n  X [label='Phenotype', pos='2,0!']\n  Y [label='Outcome', pos='4,0!']\n\n  G1 -&gt; X \n  G2 -&gt; X \n  G3 -&gt; X \n  U -&gt; X\n  U -&gt; Y\n  X -&gt; Y \n  }\n  \", height = 300)\n\n\n\n\n\nThis could be extended for more genotypes.\n\nVersion without borders around observed variables\n\nDiagrammeR::grViz(\"\n  digraph mrdag {\n\n  graph [rankdir=TB, layout=neato]\n\n  node [shape=ellipse]\n  U [label='Confounders', pos='3,1!']\n\n  node [shape=plaintext, height=0.3, width=0.3]\n  G1 [label='&lt;I&gt;G@_{1}&lt;/I&gt;', pos='0,0.75!']\n  G2 [label='&lt;I&gt;G@_{2}&lt;/I&gt;', pos='0,0!']\n  G3 [label='&lt;I&gt;G@_{3}&lt;/I&gt;', pos='0,-0.75!']\n  X [label='Phenotype', pos='2,0!']\n  Y [label='Outcome', pos='4,0!']\n\n  G1 -&gt; X \n  G2 -&gt; X \n  G3 -&gt; X \n  U -&gt; X\n  U -&gt; Y\n  X -&gt; Y \n  }\n  \", height = 300)\n\n\n\n\n\n\n\n\nMVMR DAGs\nWe can plot the DAGs in Figure 4 of Sanderson et al. (2019) here.\n\nScenario 1: \\(X_2\\) confounder of \\(X_1\\) and \\(Y\\)\n\nDiagrammeR::grViz(\"\n  digraph mrdag {\n\n  graph [rankdir=TB, layout=neato]\n\n  node [shape=ellipse]\n  U [label='Confounders', pos='3,1!']\n\n  node [shape=plaintext, height=0.3, width=0.3]\n  G1 [label='&lt;I&gt;G@_{1}&lt;/I&gt;', pos='0,0!']\n  X1 [label='&lt;I&gt;X@_{1}&lt;/I&gt;', pos='2,0!']\n  Y [label=&lt;&lt;I&gt;Y&lt;/I&gt;&gt;, pos='4,0!']\n  G2 [label='&lt;I&gt;G@_{2}&lt;/I&gt;', pos='0,-1!']\n  X2 [label='&lt;I&gt;X@_{2}&lt;/I&gt;', pos='2,-1!']\n\n  G1 -&gt; X1\n  G2 -&gt; X2\n  U -&gt; X1\n  U -&gt; Y\n  U -&gt; X2\n  X1 -&gt; Y\n  X2 -&gt; Y\n  X2 -&gt; X1\n  }\n  \", height = 300)\n\n\n\n\n\n\n\nScenario 2: \\(X_2\\) collider of \\(X_1\\) and \\(Y\\)\n\nDiagrammeR::grViz(\"\n  digraph mrdag {\n\n  graph [rankdir=TB, layout=neato]\n\n  node [shape=ellipse]\n  U [label='Confounders', pos='3,1!']\n\n  node [shape=plaintext, height=0.3, width=0.3]\n  G1 [label='&lt;I&gt;G@_{1}&lt;/I&gt;', pos='0,0!']\n  X1 [label='&lt;I&gt;X@_{1}&lt;/I&gt;', pos='2,0!']\n  Y [label=&lt;&lt;I&gt;Y&lt;/I&gt;&gt;, pos='4,0!']\n  G2 [label='&lt;I&gt;G@_{2}&lt;/I&gt;', pos='0,-1!']\n  X2 [label='&lt;I&gt;X@_{2}&lt;/I&gt;', pos='2,-1!']\n\n  G1 -&gt; X1\n  G2 -&gt; X2\n  U -&gt; X1\n  U -&gt; Y\n  U -&gt; X2\n  X1 -&gt; Y\n  Y -&gt; X2\n  X1 -&gt; X2\n  }\n  \", height = 300)\n\n\n\n\n\n\n\nScenario 3: \\(X_2\\) on a pleiotropic pathway\n\nDiagrammeR::grViz(\"\n  digraph mrdag {\n\n  graph [rankdir=TB, layout=neato]\n\n  node [shape=ellipse]\n  U [label='Confounders', pos='3,1!']\n\n  node [shape=plaintext, height=0.3, width=0.3]\n  G1 [label='&lt;I&gt;G@_{1}&lt;/I&gt;', pos='0,0!']\n  X1 [label='&lt;I&gt;X@_{1}&lt;/I&gt;', pos='2,0!']\n  Y [label=&lt;&lt;I&gt;Y&lt;/I&gt;&gt;, pos='4,0!']\n  G2 [label='&lt;I&gt;G@_{2}&lt;/I&gt;', pos='0,-1!']\n  X2 [label='&lt;I&gt;X@_{2}&lt;/I&gt;', pos='2,-1!']\n\n  G1 -&gt; X1\n  G2 -&gt; X2\n  U -&gt; X1\n  U -&gt; Y\n  U -&gt; X2\n  X1 -&gt; Y\n  X2 -&gt; Y\n  }\n  \", height = 300)\n\n\n\n\n\n\n\nScenario 4: \\(X_2\\) mediator of the effect of \\(X_1\\) on \\(Y\\)\n\nDiagrammeR::grViz(\"\n  digraph mrdag {\n\n  graph [rankdir=TB, layout=neato]\n\n  node [shape=ellipse]\n  U [label='Confounders', pos='3,1!']\n\n  node [shape=plaintext, height=0.3, width=0.3]\n  G1 [label='&lt;I&gt;G@_{1}&lt;/I&gt;', pos='0,0!']\n  X1 [label='&lt;I&gt;X@_{1}&lt;/I&gt;', pos='2,0!']\n  Y [label=&lt;&lt;I&gt;Y&lt;/I&gt;&gt;, pos='4,0!']\n  G2 [label='&lt;I&gt;G@_{2}&lt;/I&gt;', pos='0,-1!']\n  X2 [label='&lt;I&gt;X@_{2}&lt;/I&gt;', pos='2,-1!']\n\n  edge [arrowhead='vee']\n  G1 -&gt; X1\n  G2 -&gt; X2\n  U -&gt; X1\n  U -&gt; Y\n  U -&gt; X2\n  X1 -&gt; Y\n  X2 -&gt; Y\n  X1 -&gt; X2\n  }\n  \", height = 300)\n\n\n\n\n\n\n\n\nBidirectional MR figure of combined DAGs\nFor a bidirectional MR analysis there are 2 separate DAGs which are as follows.\n\nDiagrammeR::grViz(\"\n  digraph mrdag {\n\n  graph [rankdir=TB, layout=neato]\n\n  node [shape=ellipse]\n  U [label='Confounders', pos='3,1!']\n\n  node [shape=plaintext, height=0.3, width=0.3]\n  GX [label='Genotypes \\n for phenotype', pos='0,0!']\n  X [label='Phenotype', pos='2,0!']\n  Y [label='Outcome', pos='4,0!']\n\n  GX -&gt; X [penwidth=2]\n  U -&gt; X [penwidth=2]\n  U -&gt; Y [penwidth=2]\n  X -&gt; Y [penwidth=2]\n  }\n  \", height = 200)\n\n\n\n\n\n\nDiagrammeR::grViz(\"\n  digraph mrdag {\n\n  graph [rankdir=TB, layout=neato]\n\n  node [shape=ellipse]\n  U [label='Confounders', pos='3,1!']\n\n  node [shape=plaintext, height=0.3, width=0.3]\n  X [label='Phenotype', pos='2,0!']\n  Y [label='Outcome', pos='4,0!']\n  GY [label='Genotypes \\n for outcome', pos='6,0!']\n\n  U -&gt; X [penwidth=2]\n  U -&gt; Y [penwidth=2]\n  Y -&gt; X [penwidth=2]\n  GY -&gt; Y [penwidth=2]\n  }\n  \", height = 200)\n\n\n\n\n\nWe can combine these into a single figure as follows.\n\nDiagrammeR::grViz(\"\n  digraph mrdag {\n\n  graph [rankdir=TB, layout=neato]\n\n  node [shape=ellipse]\n  U [label='Confounders', pos='3,1!']\n\n  node [shape=plaintext, height=0.3, width=0.3]\n  GX [label='Genotypes \\n for phenotype', pos='0,0!']\n  X [label='Phenotype', pos='2,0!']\n  Y [label='Outcome', pos='4,0!']\n  GY [label='Genotypes \\n for outcome', pos='6,0!']\n\n  { rank = same; GX X Y GY }\n\n  GX -&gt; X [penwidth=2]\n  U -&gt; X [penwidth=2]\n  U -&gt; Y [penwidth=2]\n  X -&gt; Y [penwidth=2]\n  Y -&gt; X [color=blue, penwidth=2]\n  GY -&gt; Y [color=blue, penwidth=2]\n  }\n  \", height = 200)\n\n\n\n\n\nArguably we could add additional blue arrows from the Confounders node.\nIf you prefer a greyscale figure replace blue with grey/DimGrey/grey30 (or change the number as required. See here for more colors.\n\n\nPleiotropy DAGs\nThere are many types of pleiotropy. Let’s plot some of the pleiotropy DAGs from Sanderson et al. (2022).\n\nHorizontal pleiotropy (causes bias)\n\nDiagrammeR::grViz(\"\n  digraph mrdag {\n\n  graph [rankdir=TB]\n\n  node [shape=ellipse]\n  U [label='Confounders']\n\n  node [shape=plaintext, height=0.3, width=0.3]\n  G [label='Genotype']\n  X [label='Phenotype']\n  Y [label='Outcome']\n  C [label='Other phenotype']\n\n  { rank = same; G X Y }\n\n  G -&gt; X [minlen=3]\n  G -&gt; C\n  U -&gt; X\n  U -&gt; Y\n  X -&gt; Y [minlen=3]\n  C -&gt; Y\n  }\n  \", height = 300)\n\n\n\n\n\n\n\nHorizontal pleiotropy (no bias)\n\nDiagrammeR::grViz(\"\n  digraph mrdag {\n\n  graph [rankdir=TB, layout=neato]\n\n  node [shape=ellipse]\n  U [label='Confounders', pos='3,1!']\n\n  node [shape=plaintext, height=0.3, width=0.3]\n  G [label='Genotype', pos='0,0!']\n  X [label='Phenotype', pos='2,0!']\n  Y [label='Outcome', pos='4,0!']\n  C [label='Other phenotype', pos='2,-1!']\n\n  G -&gt; X\n  G -&gt; C\n  U -&gt; X\n  U -&gt; Y\n  X -&gt; Y\n  }\n  \", height = 300)\n\n\n\n\n\n\n\nConfounding via linkage disequilibrium\n\nDiagrammeR::grViz(\"\n  digraph mrdag {\n\n  graph [rankdir=TB, layout=neato]\n\n  node [shape=ellipse]\n  U [label='Confounders', pos='3,1!']\n\n  node [shape=plaintext, height=0.3, width=0.3]\n  G1 [label='Genotype 1', pos='0,0!']\n  G2 [label='Genotype 2', pos='0,-1!']\n  X [label='Phenotype', pos='2,0!']\n  Y [label='Outcome', pos='4,0!']\n  C [label='Other phenotype', pos='2,-1!']\n\n  G1 -&gt; X\n  G1 -&gt; G2 [dir='both']\n  G2 -&gt; C\n  U -&gt; X\n  U -&gt; Y\n  X -&gt; Y\n  C -&gt; Y\n  }\n  \", height = 300)\n\n\n\n\n\n\n\nVertical pleiotropy\n\nDiagrammeR::grViz(\"\n  digraph mrdag {\n\n  graph [rankdir=TB]\n\n  node [shape=ellipse]\n  U [label='Confounders']\n\n  node [shape=plaintext, height=0.3, width=0.3]\n  G [label='Genotype']\n  X [label='Phenotype 1']\n  Y [label='Outcome']\n  C [label='Phenotype 2']\n\n  { rank = same; G X C Y }\n\n  G -&gt; X [minlen=2]\n  X -&gt; C [minlen=2]\n  U -&gt; X\n  U -&gt; Y\n  C -&gt; Y [minlen=2]\n  }\n  \", height = 200)\n\n\n\n\n\n\n\nMisspecification of the primary phenotype\n\nDiagrammeR::grViz(\"\n  digraph mrdag {\n\n  graph [rankdir=TB, layout=neato]\n\n  node [shape=ellipse]\n  U [label='Confounders', pos='3,1!']\n\n  node [shape=plaintext, height=0.3, width=0.3]\n  G [label='Genotype', pos='0,0!']\n  X [label='Phenotype 1', pos='2,0!']\n  Y [label='Outcome', pos='4,0!']\n  C [label='Phenotype 2', pos='2,-1!']\n\n  G -&gt; C\n  C -&gt; X\n  U -&gt; X\n  U -&gt; Y\n  X -&gt; Y\n  C -&gt; Y\n  }\n  \", height = 300)\n\n\n\n\n\n\n\nCorrelated pleiotropy\n\nDiagrammeR::grViz(\"\n  digraph mrdag {\n\n  graph [rankdir=TB, layout=neato]\n\n  node [shape=ellipse]\n  U [label='Confounders', pos='3,1!']\n\n  node [shape=plaintext, height=0.3, width=0.3]\n  G [label='Genotype', pos='0,0!']\n  X [label='Phenotype 1', pos='2,0!']\n  Y [label='Outcome', pos='4,0!']\n  C [label='Phenotype 2', pos='2,-1!']\n\n  G -&gt; X\n  G -&gt; C\n  C -&gt; X\n  U -&gt; X\n  U -&gt; Y\n  X -&gt; Y\n  C -&gt; Y\n  }\n  \", height = 300)\n\n\n\n\n\n\n\n\nSingle genotype path diagram\n\nExplicitly including the confounder\n\nDiagrammeR::grViz(\"\n  digraph mrdag {\n\n  graph [rankdir=TB, layout=neato]\n\n  node [shape=ellipse, height=0.3, width=0.3]\n  U [label=&lt;&lt;I&gt;U&lt;/I&gt;&gt;, pos='3,1!']\n\n  node [shape=box, height=0.3, width=0.3]\n  G [label=&lt;&lt;I&gt;G&lt;/I&gt;&gt;, pos='0,0!']\n  X [label=&lt;&lt;I&gt;X&lt;/I&gt;&gt;, pos='2,0!']\n  Y [label=&lt;&lt;I&gt;Y&lt;/I&gt;&gt;, pos='4,0!']\n\n  node [shape=circle, height=0.35, fixedsize=true]\n  Ex [label='&lt;I&gt;&epsilon;@_{X}&lt;/I&gt;', pos='2,1!']\n  Ey [label='&lt;I&gt;&epsilon;@_{Y}&lt;/I&gt;', pos='4,1!']\n\n  G -&gt; X [label='&lt;I&gt;&beta;@_{GX}&lt;/I&gt;']\n  Ex -&gt; X [label=1]\n  Ey -&gt; Y [label=1]\n  U -&gt; X [label='&lt;I&gt;&beta;@_{UX}&lt;/I&gt;']\n  U -&gt; Y [label='&lt;I&gt;&beta;@_{UY}&lt;/I&gt;']\n  X -&gt; Y [label='&lt;I&gt;&beta;@_{XY}&lt;/I&gt;']\n  U -&gt; U [dir='both', headport='n', tailport='n']\n  G -&gt; G [dir='both', headport='w', tailport='w']\n  }\n  \", height = 250)\n\n\n\n\n\n\n\nIncluding variance terms\nNote in the diagram below \\(\\sigma_{X}^2\\) and \\(\\sigma_{Y}^2\\) represent the variance of the respective error/residual terms (\\(\\varepsilon_X\\), \\(\\varepsilon_Y\\)) and not the variance of \\(X\\) and \\(Y\\).\n\nDiagrammeR::grViz(\"\n  digraph mrdag {\n\n  graph [rankdir=TB, layout=neato]\n\n  node [shape=ellipse, height=0.3, width=0.3]\n  U [label=&lt;&lt;I&gt;U&lt;/I&gt;&gt;, pos='3,1!']\n\n  node [shape=box, height=0.3, width=0.3]\n  G [label=&lt;&lt;I&gt;G&lt;/I&gt;&gt;, pos='0,0!']\n  X [label=&lt;&lt;I&gt;X&lt;/I&gt;&gt;, pos='2,0!']\n  Y [label=&lt;&lt;I&gt;Y&lt;/I&gt;&gt;, pos='4,0!']\n\n  node [shape=circle, height=0.35, fixedsize=true]\n  Ex [label='&lt;I&gt;&epsilon;@_{X}&lt;/I&gt;', pos='2,1!']\n  Ey [label='&lt;I&gt;&epsilon;@_{Y}&lt;/I&gt;', pos='4,1!']\n\n  G -&gt; X [label='&lt;I&gt;&beta;@_{GX}&lt;/I&gt;']\n  Ex -&gt; X [label=1]\n  Ey -&gt; Y [label=1]\n  U -&gt; X [label='&lt;I&gt;&beta;@_{UX}&lt;/I&gt;']\n  U -&gt; Y [label='&lt;I&gt;&beta;@_{UY}&lt;/I&gt;']\n  X -&gt; Y [label='&lt;I&gt;&beta;@_{XY}&lt;/I&gt;']\n  U -&gt; U [dir='both', headport='n', tailport='n', label=&lt;var(&lt;I&gt;U&lt;/I&gt;)&gt;]\n  G -&gt; G [dir='both', headport='w', tailport='w', label=&lt;var(&lt;I&gt;G&lt;/I&gt;)&gt;]\n  Ex -&gt; Ex [dir='both', headport='n', tailport='n', label=&lt;&lt;I&gt;&sigma;@_{X}@^{2}&lt;/I&gt;&gt;]\n  Ey -&gt; Ey [dir='both', headport='n', tailport='n', label=&lt;&lt;I&gt;&sigma;@_{Y}@^{2}&lt;/I&gt;&gt;]\n  }\n  \", height = 250)\n\n\n\n\n\n\n\nIncluding correlated error terms between exposure and outcome\n\nDiagrammeR::grViz(\"\n  digraph mrdag {\n\n  graph [rankdir=TB, layout=neato, splines=true]\n\n  node [shape=box, height=0.3, width=0.3]\n  G [label=&lt;&lt;I&gt;G&lt;/I&gt;&gt;, pos='0,0!']\n  X [label=&lt;&lt;I&gt;X&lt;/I&gt;&gt;, pos='2,0!']\n  Y [label=&lt;&lt;I&gt;Y&lt;/I&gt;&gt;, pos='4,0!']\n\n  node [shape=circle, height=0.35, fixedsize=true]\n  Ex [label='&lt;I&gt;&epsilon;@_{X}&lt;/I&gt;', pos='2,1!']\n  Ey [label='&lt;I&gt;&epsilon;@_{Y}&lt;/I&gt;', pos='4,1!']\n  dummy [label='', pos='3,1!', color=white, height=0.5]\n\n  G -&gt; X [label='&lt;I&gt;&beta;@_{GX}&lt;/I&gt;']\n  Ex -&gt; X [label=1]\n  Ey -&gt; Y [label=1]\n  X -&gt; Y [label='&lt;I&gt;&beta;@_{XY}&lt;/I&gt;']\n  Ex -&gt; Ey [dir='both', label=&lt;&lt;I&gt;&rho;&lt;/I&gt;&gt;]\n  G -&gt; G [dir='both', headport='w', tailport='w']\n  }\n  \", height = 250)"
  },
  {
    "objectID": "index.html#dagitty-package",
    "href": "index.html#dagitty-package",
    "title": "R, DOT, and TikZ code to plot directed acyclic graphs and single world intervention graphs for Mendelian randomization analyses",
    "section": "dagitty package",
    "text": "dagitty package\nThe website for DAGitty is http://www.dagitty.net/\n\nlibrary(dagitty)\n\n\nUsing DOT syntax\nThe DAG for a single genotype.\n\nmrdag &lt;- dagitty('dag {\n  G -&gt; X -&gt; Y\n  X &lt;- U -&gt; Y\n  G [pos=\"0,0\"]\n  X [e, pos=\"1,0\"]\n  U [pos=\"1.5,-0.4\"]\n  Y [o, pos=\"2,0\"]\n}')\n\nplot(mrdag)\n\n\n\n\n\n\n\n\n\n\nUsing ggdag\n\nlibrary(ggdag)\nmrdag &lt;- dagitty('dag {\n  G -&gt; X -&gt; Y\n  X &lt;- U -&gt; Y\n  G [pos=\"0,0\"]\n  X [e, pos=\"1,0\"]\n  U [pos=\"1.5,0.4\"]\n  Y [o, pos=\"2,0\"]\n}')\n\nggmrdag &lt;- tidy_dagitty(mrdag)\nggdag(ggmrdag) + theme_dag()\n\n\n\n\n\n\n\n\nThis can be labelled as follows.\n\nmrdag &lt;- mrdag %&gt;%\n  dag_label(\n    labels = c(\n      \"X\" = \"Exposure\",\n      \"Y\" = \"Outcome\",\n      \"G\" = \"Genotype\",\n      \"U\" = \"Confounders\"))\nggdag(mrdag,  use_labels = \"label\") + theme_dag()\n\n\n\n\n\n\n\n\nDagitty can identify the instrumental variable on the DAG.\n\nmrdag %&gt;% ggdag_instrumental() + theme_dag()\n\n\n\n\n\n\n\n\nIt correctly identifies the genotype, \\(G\\), as the instrumental variable.\n\n\nUsing R model type syntax in ggdag\n\ncoords &lt;- list(x = c(G = 0, X = 1, Y = 2, U = 1.5),\n               y = c(G = 0, X = 0, Y = 0, U = 1))\nmrdag &lt;- dagify(\n  X ~ G + U,\n  Y ~ X + U,\n  labels = c(\n    \"G\" = \"Genotype\",\n    \"X\" = \"Exposure\",\n    \"Y\" = \"Outcome\",\n    \"U\" = \"Confounders\"\n  ),\n  exposure = \"X\",\n  outcome = \"Y\",\n  coords = coords\n)\nggdag(mrdag, use_labels = \"label\") + theme_dag()\n\n\n\n\n\n\n\n\nPlotting directly with ggplot2 functions.\n\nmrdag %&gt;%\n  ggplot(aes(\n    x = x,\n    y = y,\n    xend = xend,\n    yend = yend\n  )) +\n  geom_dag_point() +\n  geom_dag_edges() +\n  geom_dag_text() +\n  theme_dag()\n\n\n\n\n\n\n\n\nShowing the paths.\n\nset.seed(123)\ndagify(Y ~ X + U,\n       X ~ U + G,\n       exposure = \"X\",\n       outcome = \"Y\") %&gt;%\nggdag_paths() + theme_dag()\n\n\n\n\n\n\n\n\nAdjustment set for the effect of \\(X\\) on \\(Y\\).\n\ndagify(Y ~ X + U,\n       X ~ U + G,\n       exposure = \"X\",\n       outcome = \"Y\",\n       coords = coords) %&gt;%\n  ggdag_adjustment_set() + theme_dag()\n\n\n\n\n\n\n\n\nThis shows that the path from \\(G\\) to \\(X\\) is unconfounded. And that when \\(U\\) is adjusted for the path from \\(X\\) to \\(Y\\) is unconfounded.\n\n\nMultiple genotype DAG\n\ncoords2 &lt;- list(x = c(G1 = 0, G2 = 0, G3 = 0, X = 1, Y = 2, U = 1.5),\n                y = c(G1 = 0.5, G2 = 0, G3 = -0.5, X = 0, Y = 0, U = 1))\nmrdag &lt;- dagify(\n  X ~ G1,\n  X ~ G2,\n  X ~ G3,\n  Y ~ X,\n  X ~ U,\n  Y ~ U,\n  exposure = \"X\",\n  outcome = \"Y\",\n  coords = coords2\n)\nggdag(mrdag) + theme_dag()\n\n\n\n\n\n\n\n\nThis could be extended for more genotypes."
  },
  {
    "objectID": "index.html#eleanor-murrays-tikz-diagrams-using-the-tikz-code-chunk-engine",
    "href": "index.html#eleanor-murrays-tikz-diagrams-using-the-tikz-code-chunk-engine",
    "title": "R, DOT, and TikZ code to plot directed acyclic graphs and single world intervention graphs for Mendelian randomization analyses",
    "section": "Eleanor Murray’s TikZ diagrams using the tikz code chunk engine",
    "text": "Eleanor Murray’s TikZ diagrams using the tikz code chunk engine\nI believe that tikz diagrams can be included in Rmarkdown documents using the tikz code chunk engine for output types pdf_document and html_document.\nTikz is a package for LaTeX and so pdf is its natural output. So far I have not been able to include these figures in either html_notebook or word_document output formats. I suspect that the images need conversion to png files for these to work under rmarkdown.\nWe will use some of the LaTeX code for drawing DAGs using tikz provided by Eleanor Murray here.\nIn its LaTeX preamble, this code loads in several TikZ libraries. As such for our tikz code chunks to compile in our Rmd file we need to define a new template file, e.g.tikz-template.tex, and call our tikz code chunks as follows.\n```{tikz}\n#| out.width=\"65%\", \n#| engine.opts=list(template = \"tikz-template.tex\",\n#|                  dvisvgm.opts = \"--font-format=woff\")\n\\begin{tikzpicture}\n% Your tikz code goes here ...\n\\end{tikzpicture}\n```\nThe tikz-template.tex file includes the TikZ preamble code from Eleanor Murray’s LaTeX code plus the required template code. The contents of the template file is as follows.\n\\documentclass{article}\n\\usepackage[active, tightpage]{preview}\n\\usepackage{amsmath}\n\\usepackage{tikz}\n\\usetikzlibrary{positioning, calc, shapes.geometric, shapes.multipart,\n    shapes, arrows.meta, arrows, decorations.markings, external, trees}\n\n% Create custom arrow style:\n\\tikzstyle{Arrow} = [\n  thick,\n  decoration={markings,\n              mark=at position 1 with {\\arrow[thick]{latex}}},\n  shorten &gt;= 3pt, \n  preaction = {decorate}\n]\n\n\\tikzstyle{BlueArrow} = [\n  thick,\n  decoration={markings,\n              mark=at position 1 with {\\arrow[thick, blue]{latex}}},\n  shorten &gt;= 3pt, \n  preaction = {decorate},\n  color = blue\n]\n\n\\begin{document}\n\\begin{preview}\n%% TIKZ_CODE %%\n\\end{preview}\n\\end{document}\nWe can now plot our DAGs.\n\nSingle genotype DAGs using TikZ\n\nSpecifying node coordinates\n\n\\begin{tikzpicture}\n\\node (1) at (0,0) {$G$};\n\\node (2) at (1.5,0) {$X$};\n\\node (3) at (3,0) {$Y$};\n\\node (4) at (2.25,1) {$U$};\n\\draw[Arrow] (1) -- (2);\n\\draw[Arrow] (2) -- (3);\n\\draw[Arrow] (4) -- (2);\n\\draw[Arrow] (4) -- (3);\n\\end{tikzpicture}\n\n\n\n\n\n\n\n\n\n\nSingle genotype DAG using tikz-cd\nThe tikz-cd package provides helpful syntax for making commutative diagrams which we can use to produce DAGs.\nFirst install the package.\ntinytex::tlmgr_install(\"tikz-cd\")\nThen we can plot the single instrument DAG using the following code.\n\n\\usetikzlibrary{cd}\n\\tikzcdset{arrow style=tikz, diagrams={&gt;=stealth}}\n\\begin{tikzcd}[column sep=tiny]\n& & & & U \\arrow[dl, thick] \\arrow[dr, thick] & \\\\\nG \\arrow[thick]{rrr} & & & X \\arrow[thick]{rr} & & Y\n\\end{tikzcd}\n\n\n\n\n\n\n\n\n\n\nSingle genotype DAG using simpler TikZ code\n\n\\usetikzlibrary{positioning}\n\\tikzset{\n    &gt; = stealth,\n    every path/.append style = {\n        arrows = -&gt;,\n        thick\n    }\n}\n\\tikz{\n    \\node (g) {$G$};\n    \\node (x) [right = of g] {$X$};\n    \\node (y) [right = of x] {$Y$};\n    \\node (u) [above right = 0.5cm and 0.25cm of x] {$U$};\n    \\path (g) edge (x);\n    \\path (x) edge (y);\n    \\path (u) edge (x);\n    \\path (u) edge (y);\n}\n\n\n\n\n\n\n\n\n\n\n\nMultiple genotype DAGs using TikZ\n\nSpecifying node coordinates\n\n\\begin{tikzpicture}\n\\node (1) at (0,0) {$G_2$};\n\\node (2) at (1.5,0) {$X$};\n\\node (3) at (3,0) {$Y$};\n\\node (4) at (2.25,1) {$U$};\n\\node (5) at (0,0.5) {$G_1$};\n\\node (6) at (0,-0.5) {$G_3$};\n\\draw[Arrow] (1) -- (2);\n\\draw[Arrow] (2) -- (3);\n\\draw[Arrow] (4) -- (2);\n\\draw[Arrow] (4) -- (3);\n\\draw[Arrow] (5) -- (2);\n\\draw[Arrow] (6) -- (2);\n\\end{tikzpicture}\n\n\n\n\n\n\n\n\nAgain this could be extended for more genotypes.\n\n\nMultiple genotype DAG using circularly spaced genotypes\n\n\\begin{tikzpicture}\n\\node (1) at (0,0) {$G_2$};\n\\node (2) at (1.5,0) {$X$};\n\\node (3) at (3,0) {$Y$};\n\\node (4) at (2.25,1) {$U$};\n\\node (5) at ([shift=({160:1.5})]2) {$G_1$};\n\\node (6) at ([shift=({200:1.5})]2) {$G_3$};\n\\draw[Arrow] (1) -- (2);\n\\draw[Arrow] (2) -- (3);\n\\draw[Arrow] (4) -- (2);\n\\draw[Arrow] (4) -- (3);\n\\draw[Arrow] (5) -- (2);\n\\draw[Arrow] (6) -- (2);\n\\end{tikzpicture}\n\n\n\n\n\n\n\n\n\n\n\nPleiotropy DAGs using TikZ\n\nHorizontal pleiotropy (causes bias)\n\n\\usetikzlibrary{positioning}\n\\tikzset{\n    &gt; = stealth,\n    every path/.append style = {\n        arrows = -&gt;,\n        thick\n    }\n}\n\\tikz{\n    \\node (g) {$G$};\n    \\node (x1) [right = of g] {$X_1$};\n    \\node (y) [right = of x1] {$Y$};\n    \\node (u) [above right = 0.5cm and 0.25cm of x1] {$U$};\n    \\node (x2) [below = 0.5cm of x1] {$X_2$};\n    \\path (g) edge (x1);\n    \\path (x1) edge (y);\n    \\path (u) edge (x1);\n    \\path (u) edge (y);\n    \\path (g) edge (x2);\n    \\path (x2) edge (y);\n}\n\n\n\n\n\n\n\n\n\n\nHorizontal pleiotropy (no bias)\n\n\\usetikzlibrary{positioning}\n\\tikzset{\n    &gt; = stealth,\n    every path/.append style = {\n        arrows = -&gt;,\n        thick\n    }\n}\n\\tikz{\n    \\node (g) {$G$};\n    \\node (x1) [right = of g] {$X_1$};\n    \\node (y) [right = of x1] {$Y$};\n    \\node (u) [above right = 0.5cm and 0.25cm of x1] {$U$};\n    \\node (x2) [below = 0.5cm of x1] {$X_2$};\n    \\path (g) edge (x1);\n    \\path (x1) edge (y);\n    \\path (u) edge (x1);\n    \\path (u) edge (y);\n    \\path (g) edge (x2);\n}\n\n\n\n\n\n\n\n\n\n\nConfounding via linkage disequilibrium\n\n\\usetikzlibrary{positioning}\n\\tikzset{\n    &gt; = stealth,\n    every path/.append style = {\n        arrows = -&gt;,\n        thick\n    }\n}\n\\tikz{\n    \\node (g1) {$G_1$};\n    \\node (x1) [right = of g1] {$X_1$};\n    \\node (y) [right = of x1] {$Y$};\n    \\node (u) [above right = 0.5cm and 0.25cm of x1] {$U$};\n    \\node (x2) [below = 0.5cm of x1] {$X_2$};\n    \\node (g2) [below = 0.5cm of g1] {$G_2$};\n    \\path (g1) edge (x1);\n    \\path (x1) edge (y);\n    \\path (u) edge (x1);\n    \\path (u) edge (y);\n    \\draw[&lt;-&gt;] (g1) -- (g2);\n    \\path (g2) edge (x2);\n    \\path (x2) edge (y);\n}\n\n\n\n\n\n\n\n\n\n\nVertical pleiotropy\n\n\\usetikzlibrary{positioning}\n\\tikzset{\n    &gt; = stealth,\n    every path/.append style = {\n        arrows = -&gt;,\n        thick\n    }\n}\n\\tikz{\n    \\node (g) {$G$};\n    \\node (x1) [right = of g] {$X_1$};\n    \\node (x2) [right = of x1] {$X_2$};\n    \\node (y) [right = of x2] {$Y$};\n    \\node (u) [above = 0.5cm of x2] {$U$};\n    \\path (g) edge (x1);\n    \\path (x1) edge (x2);\n    \\path (u) edge (x1);\n    \\path (u) edge (y);\n    \\path (x2) edge (y);\n}\n\n\n\n\n\n\n\n\n\n\nMisspecification of the primary phenotype\n\n\\usetikzlibrary{positioning}\n\\tikzset{\n    &gt; = stealth,\n    every path/.append style = {\n        arrows = -&gt;,\n        thick\n    }\n}\n\\tikz{\n    \\node (g) {$G$};\n    \\node (x1) [right = of g] {$X_1$};\n    \\node (y) [right = of x1] {$Y$};\n    \\node (u) [above right = 0.5cm and 0.25cm of x1] {$U$};\n    \\node (x2) [below = 0.5cm of x1] {$X_2$};\n    \\path (x1) edge (y);\n    \\path (u) edge (x1);\n    \\path (u) edge (y);\n    \\path (g) edge (x2);\n    \\path (x2) edge (x1);\n    \\path (x2) edge (y);\n}\n\n\n\n\n\n\n\n\n\n\nCorrelated pleiotropy\n\n\\usetikzlibrary{positioning}\n\\tikzset{\n    &gt; = stealth,\n    every path/.append style = {\n        arrows = -&gt;,\n        thick\n    }\n}\n\\tikz{\n    \\node (g) {$G$};\n    \\node (x1) [right = of g] {$X_1$};\n    \\node (y) [right = of x1] {$Y$};\n    \\node (u) [above right = 0.5cm and 0.25cm of x1] {$U$};\n    \\node (x2) [below = 0.5cm of x1] {$X_2$};\n    \\path (x1) edge (y);\n    \\path (u) edge (x1);\n    \\path (u) edge (y);\n    \\path (g) edge (x2);\n    \\path (x2) edge (x1);\n    \\path (x2) edge (y);\n    \\path (g) edge (x1);\n    \\path (g) edge (x2);\n}\n\n\n\n\n\n\n\n\n\n\n\nBidirectional MR figure of combined DAGs using TikZ\nFor a bidirectional MR analysis there are 2 separate DAGs, which are as follows.\n\n\\begin{tikzpicture}\n\\node (1) at (0,0) {$G_X$};\n\\node (2) at (1.5,0) {$X$};\n\\node (3) at (3,0) {$Y$};\n\\node (4) at (2.25,1) {$U$};\n\\draw[Arrow] (1) -- (2);\n\\draw[Arrow] (2) -- (3);\n\\draw[Arrow] (4) -- (2);\n\\draw[Arrow] (4) -- (3);\n\\end{tikzpicture}\n\n\n\n\n\n\n\n\n\n\\begin{tikzpicture}\n\\node (2) at (1.5,0) {$X$};\n\\node (3) at (3,0) {$Y$};\n\\node (4) at (2.25,1) {$U$};\n\\node (5) at (4.5,0) {$G_Y$};\n\\draw[Arrow] (3) -- (2);\n\\draw[Arrow] (4) -- (2);\n\\draw[Arrow] (4) -- (3);\n\\draw[Arrow] (5) -- (3);\n\\end{tikzpicture}\n\n\n\n\n\n\n\n\nWe can combine these into a single figure as follows.\n\n\\begin{tikzpicture}\n\\node (1) at (0,0) {$G_X$};\n\\node (2) at (1.5,0) {$X$};\n\\node (3) at (3,0) {$Y$};\n\\node (4) at (2.25,1) {$U$};\n\\node (5) at (4.5,0) {$G_Y$};\n% Create dummy X and Y nodes with no content\n\\node (6) at (1.5,-0.05) {\\phantom{$X$}};\n\\node (7) at (3,-0.05) {\\phantom{$Y$}};\n\\node (8) at (1.5,0.05) {\\phantom{$X$}};\n\\node (9) at (3,0.05) {\\phantom{$Y$}};\n\\draw[Arrow] (1) -- (2);\n\\draw[Arrow] (8) -- (9);\n\\draw[BlueArrow] (7) -- (6);\n\\draw[Arrow] (4) -- (2);\n\\draw[Arrow] (4) -- (3);\n\\draw[BlueArrow] (5) -- (3);\n\\end{tikzpicture}\n\n\n\n\n\n\n\n\n\n\nMVMR DAGs using TikZ\nWe can plot the DAGs in Figure 4 of Sanderson et al. (2019) here.\n\nScenario 1: \\(X_2\\) confounder of \\(X_1\\) and \\(Y\\)\n\n\\begin{tikzpicture}\n\\node (1) at (0,0) {$G_2$};\n\\node (2) at (1.5,0) {$X_2$};\n\\node (3) at (4.5,1) {$Y$};\n\\node (4) at (3,2) {$U$};\n\\node (5) at (0,1) {$G_1$};\n\\node (6) at (1.5,1) {$X_1$};\n\\draw[Arrow] (1) -- (2);\n\\draw[Arrow] (2) -- (3);\n\\draw[Arrow] (4) -- (2);\n\\draw[Arrow] (4) -- (3);\n\\draw[Arrow] (5) -- (6);\n\\draw[Arrow] (6) -- (3);\n\\draw[Arrow] (4) -- (6);\n\\draw[Arrow] (2) -- (6);\n\\end{tikzpicture}\n\n\n\n\n\n\n\n\n\n\nScenario 2: \\(X_2\\) collider of \\(X_1\\) and \\(Y\\)\n\n\\begin{tikzpicture}\n\\node (1) at (0,0) {$G_2$};\n\\node (2) at (1.5,0) {$X_2$};\n\\node (3) at (4.5,1) {$Y$};\n\\node (4) at (3,2) {$U$};\n\\node (5) at (0,1) {$G_1$};\n\\node (6) at (1.5,1) {$X_1$};\n\\draw[Arrow] (1) -- (2);\n\\draw[Arrow] (3) -- (2);\n\\draw[Arrow] (4) -- (2);\n\\draw[Arrow] (4) -- (3);\n\\draw[Arrow] (5) -- (6);\n\\draw[Arrow] (6) -- (3);\n\\draw[Arrow] (4) -- (6);\n\\draw[Arrow] (6) -- (2);\n\\end{tikzpicture}\n\n\n\n\n\n\n\n\n\n\nScenario 3: \\(X_2\\) on a pleiotropic pathway\n\n\\begin{tikzpicture}\n\\node (1) at (0,0) {$G_2$};\n\\node (2) at (1.5,0) {$X_2$};\n\\node (3) at (4.5,1) {$Y$};\n\\node (4) at (3,2) {$U$};\n\\node (5) at (0,1) {$G_1$};\n\\node (6) at (1.5,1) {$X_1$};\n\\draw[Arrow] (1) -- (2);\n\\draw[Arrow] (2) -- (3);\n\\draw[Arrow] (4) -- (2);\n\\draw[Arrow] (4) -- (3);\n\\draw[Arrow] (5) -- (6);\n\\draw[Arrow] (6) -- (3);\n\\draw[Arrow] (4) -- (6);\n\\end{tikzpicture}\n\n\n\n\n\n\n\n\n\n\nScenario 4: \\(X_2\\) mediator of the effect of \\(X_1\\) on \\(Y\\)\n\n\\begin{tikzpicture}\n\\node (1) at (0,0) {$G_2$};\n\\node (2) at (1.5,0) {$X_2$};\n\\node (3) at (4.5,1) {$Y$};\n\\node (4) at (3,2) {$U$};\n\\node (5) at (0,1) {$G_1$};\n\\node (6) at (1.5,1) {$X_1$};\n\\draw[Arrow] (1) -- (2);\n\\draw[Arrow] (2) -- (3);\n\\draw[Arrow] (4) -- (2);\n\\draw[Arrow] (4) -- (3);\n\\draw[Arrow] (5) -- (6);\n\\draw[Arrow] (6) -- (3);\n\\draw[Arrow] (4) -- (6);\n\\draw[Arrow] (6) -- (2);\n\\end{tikzpicture}"
  },
  {
    "objectID": "index.html#quickdag-package",
    "href": "index.html#quickdag-package",
    "title": "R, DOT, and TikZ code to plot directed acyclic graphs and single world intervention graphs for Mendelian randomization analyses",
    "section": "quickdag package",
    "text": "quickdag package\nWe can produce some nice plots with the quickdag package, which appears to be based on Eleanor Murray’s TikZ code, from here\n\nSingle genotype DAG\n\nif (!require(\"quickdag\")) remotes::install_github(\"jrgant/quickdag\")\nlibrary(quickdag)\nedges &lt;- c(\"G -&gt; X\",\n           \"X -&gt; Y\",\n           \"U -&gt; {X Y}\")\n# DAG\ndag  &lt;- qd_dag(edges, verbose = FALSE)\ndag %&gt;% render_graph()\n\n\n\n\n\n\n\nSingle genotype SWIG\nWe can also draw the single world intervention graph (SWIG) for the IV model as follows.\n\nswig &lt;- dag %&gt;%\n  qd_swig(fixed.nodes = c(\"G\", \"X\"))\nswig %&gt;% render_graph()"
  },
  {
    "objectID": "index.html#thomas-richardsons-tikz-code-for-swigs",
    "href": "index.html#thomas-richardsons-tikz-code-for-swigs",
    "title": "R, DOT, and TikZ code to plot directed acyclic graphs and single world intervention graphs for Mendelian randomization analyses",
    "section": "Thomas Richardson’s TikZ code for SWIGs",
    "text": "Thomas Richardson’s TikZ code for SWIGs\nThomas Richardson provides a TikZ/PGF shape library for SWIGs called tikz-swigs, which is available on CTAN here.\n\nInstall the package into your TinyTeX installation with\ntinytex::tlmgr_install(\"tikz-swigs\")\nIts user manual is available here\n\nTo use the tikz chunk engine we again write a LaTeX template based on the preamble in the article by Richardson. The LaTeX template is as follows.\n\\documentclass{article}\n\\usepackage[active, tightpage]{preview}\n\\usepackage{amsmath}\n\\usepackage{pgf, tikz}\n\\usetikzlibrary{arrows, shapes.arrows, shapes.geometric, shapes.multipart,\ndecorations.pathmorphing, positioning, swigs}\n\n\\begin{document}\n\\begin{preview}\n%% TIKZ_CODE %%\n\\end{preview}\n\\end{document}\n\nSWIGs for single exposure models\nWe will recreate the SWIG template in Figure 2 (b) of Swanson et al. here.\n\n\\begin{tikzpicture}\n\\tikzset{line width=1.5pt, outer sep=0pt,\n  ell/.style={draw, fill=white, inner sep=2pt,\n  line width=1.5pt},\n  swig vsplit={gap=5pt, inner line width right=0.5pt},\n  swig hsplit={gap=5pt, inner line width lower=0.5pt}};\n\n\\node[name=G, shape=swig vsplit]{\n\\nodepart{left}{$G$}\n\\nodepart{right}{$g$}};\n\n\\node[name=X, right=10mm of G,\n  shape=swig hsplit]{\n\\nodepart{upper}{$X^g$}\n\\nodepart{lower}{$x$}};\n\n\\node[name=U, ell, shape=ellipse, above right=7.5mm and 5mm of X, fill=gray]{$U$};\n\n\\node[name=Y, ell, shape=ellipse, right=10mm of X]{$Y^x$};\n\n\\draw[-&gt;, line width=1.5pt,&gt;=stealth]\n  (G) edge[out=360, in=170] (X)\n  (U) edge (X)\n  (U) edge (Y)\n  (X) to[out=330, in=180] (Y);\n\\end{tikzpicture}\n\n\n\n\n\n\n\n\nLet’s add colour in the same way as in the original figure.\n\n\\begin{tikzpicture}\n\\tikzset{line width=1.5pt, outer sep=0pt,\n  ell/.style={draw, fill=white, inner sep=2pt,\n  line width=1.5pt},\n  swig vsplit={gap=5pt},\n  swig hsplit={gap=5pt, inner line width lower=0.5pt}};\n\n\\node[name=G, shape=swig vsplit,\n  swig vsplit={line color right=red}]{\n\\nodepart{left}{$G$}\n\\nodepart{right}{\\textcolor{red}{$g$}}};\n\n\\node[name=X, right=10mm of G,\n  shape=swig hsplit,\n  swig hsplit = {line color lower=red,\n                 line width lower=2.5pt}]{\n\\nodepart{upper}{$X^{\\textcolor{red}{g}}$}\n\\nodepart{lower}{\\textcolor{red}{$x$}}};\n\n\\node[name=U, ell, shape=ellipse, above right=7.5mm and 5mm of X, fill=gray]{$U$};\n\n\\node[name=Y, ell, shape=ellipse, right=10mm of X]{$Y^{\\textcolor{red}{x}}$};\n\n\\draw[-&gt;, line width=1.5pt,&gt;=stealth, color=blue]\n  (G) edge[out=360, in=170] (X)\n  (U) edge (X)\n  (U) edge (Y)\n  (X) to[out=330, in=180] (Y);\n\\end{tikzpicture}\n\n\n\n\n\n\n\n\n\n\nSWIGs for MVMR models\nLet’s attempt the SWIG for the multivariable Mendelian randomization (MVMR) model.\n\nSWIG for MVMR model with 2 independent exposures\nSince \\(G_1\\) an instrument for both \\(X_1\\) and \\(X_2\\), \\(X_2\\) represents a pleiotropic effect in this case.\n\n\\begin{tikzpicture}\n\\tikzset{line width=1.5pt, outer sep=0pt,\n  ell/.style={draw, fill=white, inner sep=2pt,\n  line width=1.5pt},\n  swig vsplit={gap=5pt},\n  swig hsplit={gap=5pt, inner line width lower=0.5pt}};\n\n\\node[name=G1, \n  shape=swig vsplit,\n  swig vsplit={line color right=red}]{\n\\nodepart{left}{$G_1$}\n\\nodepart{right}{\\textcolor{red}{$g_1$}}};\n\n\\node[name=X1, \n  right=10mm of G1,\n  shape=swig hsplit,\n  swig hsplit = {line color lower=red,\n                 line width lower=2.5pt}]{\n\\nodepart{upper}{$X_1^{\\phantom{1}\\textcolor{red}{g_1,\\,g_2}}$}\n\\nodepart{lower}{\\textcolor{red}{$x_1$}}};\n\n\\node[name=X2, \n  below = 1mm of X1,\n  shape=swig hsplit,\n  swig hsplit = {line color lower=red,\n                 line width lower=2.5pt}]{\n\\nodepart{upper}{$X_2^{\\phantom{2}\\textcolor{red}{g_1,\\,g_2}}$}\n\\nodepart{lower}{\\textcolor{red}{$x_2$}}};\n\n\\node[name=G2, \n  left = 10mm of X2,\n  shape=swig vsplit,\n  swig vsplit={line color right=red}]{\n\\nodepart{left}{$G_2$}\n\\nodepart{right}{\\textcolor{red}{$g_2$}}};\n\n\\node[name=U, \n  ell, \n  shape=ellipse, \n  above right=7.5mm and 5mm of X1, \n  fill=gray]{$U$};\n\n\\node[name=Y, \n  ell, \n  shape=ellipse, \n  below right=2mm and 20mm of X1]{$Y^{\\textcolor{red}{x_1, x_2}}$};\n\n\\draw[-&gt;, line width=1.5pt,&gt;=stealth, color=blue]\n  (G1) edge[out=360, in=150] (X1)\n  (G1) edge[out=360, in=150] (X2)\n  (G2) edge[out=360, in=170] (X2)\n  (G2) edge[out=360, in=170] (X1)\n  (U) edge (X1)\n  (U) edge[out=270, in=45] (X2)\n  (U) edge (Y)\n  (X1) edge[out=330, in=170] (Y)\n  (X2) to[out=330, in=190] (Y);\n\\end{tikzpicture}\n\n\n\n\n\n\n\n\n\n\nSWIG for MVMR model with \\(X_2\\) confounder of \\(X_1\\)–\\(Y\\)\n\n\\begin{tikzpicture}\n\\tikzset{line width=1.5pt, outer sep=0pt,\n  ell/.style={draw, fill=white, inner sep=2pt,\n  line width=1.5pt},\n  swig vsplit={gap=5pt},\n  swig hsplit={gap=5pt, inner line width lower=0.5pt}};\n\n\\node[name=G1, \n  shape=swig vsplit,\n  swig vsplit={line color right=red}]{\n\\nodepart{left}{$G_1$}\n\\nodepart{right}{\\textcolor{red}{$g_1$}}};\n\n\\node[name=X1, \n  right=10mm of G1,\n  shape=swig hsplit,\n  swig hsplit = {line color lower=red,\n                 line width lower=2.5pt}]{\n\\nodepart{upper}{$X_1^{\\phantom{1}\\textcolor{red}{g_1,\\,g_2,\\,x_2}}$}\n\\nodepart{lower}{\\textcolor{red}{$x_1$}}};\n\n\\node[name=X2, \n  below = 3mm of X1,\n  shape=swig hsplit,\n  swig hsplit = {line color lower=red,\n                 line width lower=2.5pt}]{\n\\nodepart{upper}{$X_2^{\\phantom{2}\\textcolor{red}{g_1,\\,g_2}\\phantom{,\\,x_2}}$}\n\\nodepart{lower}{\\textcolor{red}{$x_2$}}};\n\n\\node[name=G2, \n  left = 10mm of X2,\n  shape=swig vsplit,\n  swig vsplit={line color right=red}]{\n\\nodepart{left}{$G_2$}\n\\nodepart{right}{\\textcolor{red}{$g_2$}}};\n\n\\node[name=U, \n  ell, \n  shape=ellipse, \n  above right=7.5mm and 5mm of X1, \n  fill=gray]{$U$};\n\n\\node[name=Y, \n  ell, \n  shape=ellipse, \n  below right=2mm and 30mm of X1]{$Y^{\\textcolor{red}{x_1,\\,x_2}}$};\n\n\\draw[-&gt;, line width=1.5pt,&gt;=stealth, color=blue]\n  (G1) edge[out=360, in=150] (X1)\n  (G1) edge[out=360, in=150] (X2)\n  (G2) edge[out=360, in=170] (X2)\n  (G2) edge[out=360, in=170] (X1)\n  (U) edge (X1)\n  (U) edge[out=270, in=45] (X2)\n  (U) edge (Y)\n  (X2) edge[out=330, in=10] (X1)\n  (X1) edge[out=330, in=170] (Y)\n  (X2) to[out=330, in=190] (Y);\n\\end{tikzpicture}\n\n\n\n\n\n\n\n\n\n\nSWIG for MVMR model with \\(X_2\\) collider of \\(X_1\\)–\\(Y\\)\n\n\\begin{tikzpicture}\n\\tikzset{line width=1.5pt, outer sep=0pt,\n  ell/.style={draw, fill=white, inner sep=2pt,\n  line width=1.5pt},\n  swig vsplit={gap=5pt},\n  swig hsplit={gap=5pt, inner line width lower=0.5pt}};\n\n\\node[name=G1, \n  shape=swig vsplit,\n  swig vsplit={line color right=red}]{\n\\nodepart{left}{$G_1$}\n\\nodepart{right}{\\textcolor{red}{$g_1$}}};\n\n\\node[name=X1, \n  right=10mm of G1,\n  shape=swig hsplit,\n  swig hsplit = {line color lower=red,\n                 line width lower=2.5pt}]{\n\\nodepart{upper}{$X_1^{\\phantom{1}\\textcolor{red}{g_1,\\,g_2\\phantom{,\\,x_1,\\,y}}}$}\n\\nodepart{lower}{\\textcolor{red}{$x_1$}}};\n\n\\node[name=X2, \n  below = 3mm of X1,\n  shape=swig hsplit,\n  swig hsplit = {line color lower=red,\n                 line width lower=2.5pt}]{\n\\nodepart{upper}{$X_2^{\\phantom{2}\\textcolor{red}{g_1,\\,g_2,\\,x_1,\\,y}}$}\n\\nodepart{lower}{\\textcolor{red}{$x_2$}}};\n\n\\node[name=G2, \n  left = 10mm of X2,\n  shape=swig vsplit,\n  swig vsplit={line color right=red}]{\n\\nodepart{left}{$G_2$}\n\\nodepart{right}{\\textcolor{red}{$g_2$}}};\n\n\\node[name=U, \n  ell, \n  shape=ellipse, \n  above right=7.5mm and 5mm of X1, \n  fill=gray]{$U$};\n\n\\node[name=Y, \n  shape=swig hsplit,\n  swig hsplit={line color lower=red},\n  below right=2mm and 30mm of X1]{\n  \\nodepart{upper}{$Y^{\\textcolor{red}{x_1}}$}\n  \\nodepart{lower}{$\\textcolor{red}{y}$}};\n\n\\draw[-&gt;, line width=1.5pt,&gt;=stealth, color=blue]\n  (G1) edge[out=360, in=150] (X1)\n  (G1) edge[out=360, in=150] (X2)\n  (G2) edge[out=360, in=170] (X2)\n  (G2) edge[out=360, in=170] (X1)\n  (U) edge (X1)\n  (U) edge[out=270, in=45] (X2)\n  (U) edge (Y)\n  (X1) edge[out=330, in=20] (X2)\n  (X1) edge[out=330, in=170] (Y)\n  (Y) to[out=220, in=10] (X2);\n\\end{tikzpicture}\n\n\n\n\n\n\n\n\n\n\nSWIG for MVMR model with \\(X_2\\) mediator of \\(X_1\\)–\\(Y\\)\n\n\\begin{tikzpicture}\n\\tikzset{line width=1.5pt, outer sep=0pt,\n  ell/.style={draw, fill=white, inner sep=2pt,\n  line width=1.5pt},\n  swig vsplit={gap=5pt},\n  swig hsplit={gap=5pt, inner line width lower=0.5pt}};\n\n\\node[name=G1, \n  shape=swig vsplit,\n  swig vsplit={line color right=red}]{\n\\nodepart{left}{$G_1$}\n\\nodepart{right}{\\textcolor{red}{$g_1$}}};\n\n\\node[name=X1, \n  right=10mm of G1,\n  shape=swig hsplit,\n  swig hsplit = {line color lower=red,\n                 line width lower=2.5pt}]{\n\\nodepart{upper}{$X_1^{\\phantom{1}\\textcolor{red}{g_1,\\,g_2\\phantom{,\\,x_2}}}$}\n\\nodepart{lower}{\\textcolor{red}{$x_1$}}};\n\n\\node[name=X2, \n  below = 3mm of X1,\n  shape=swig hsplit,\n  swig hsplit = {line color lower=red,\n                 line width lower=2.5pt}]{\n\\nodepart{upper}{$X_2^{\\phantom{2}\\textcolor{red}{g_1,\\,g_2,\\,x_1}}$}\n\\nodepart{lower}{\\textcolor{red}{$x_2$}}};\n\n\\node[name=G2, \n  left = 10mm of X2,\n  shape=swig vsplit,\n  swig vsplit={line color right=red}]{\n\\nodepart{left}{$G_2$}\n\\nodepart{right}{\\textcolor{red}{$g_2$}}};\n\n\\node[name=U, \n  ell, \n  shape=ellipse, \n  above right=7.5mm and 5mm of X1, \n  fill=gray]{$U$};\n\n\\node[name=Y, \n  ell, \n  shape=ellipse, \n  below right=2mm and 30mm of X1]{$Y^{\\textcolor{red}{x_1,\\,x_2}}$};\n\n\\draw[-&gt;, line width=1.5pt,&gt;=stealth, color=blue]\n  (G1) edge[out=360, in=150] (X1)\n  (G1) edge[out=360, in=150] (X2)\n  (G2) edge[out=360, in=170] (X2)\n  (G2) edge[out=360, in=170] (X1)\n  (U) edge (X1)\n  (U) edge[out=270, in=45] (X2)\n  (U) edge (Y)\n  (X1) edge[out=330, in=35] (X2)\n  (X1) edge[out=330, in=170] (Y)\n  (X2) to[out=330, in=190] (Y);\n\\end{tikzpicture}"
  },
  {
    "objectID": "index.html#excalidraw-diagrams",
    "href": "index.html#excalidraw-diagrams",
    "title": "R, DOT, and TikZ code to plot directed acyclic graphs and single world intervention graphs for Mendelian randomization analyses",
    "section": "Excalidraw diagrams",
    "text": "Excalidraw diagrams\nhttps://excalidraw.com/ is a virtual whiteboard for sketching hand-drawn like diagrams, such as the MR DAG!\n\n\n\n\n\n\n\n\n\nIf you want to download the image above to upload into excalidraw, please download it as a png or svg.\nAnd the DAG showing effects that are not allowed under the IV core conditions."
  },
  {
    "objectID": "index.html#session-information-for-reproducibility",
    "href": "index.html#session-information-for-reproducibility",
    "title": "R, DOT, and TikZ code to plot directed acyclic graphs and single world intervention graphs for Mendelian randomization analyses",
    "section": "Session information for reproducibility",
    "text": "Session information for reproducibility\n\n\nClick here for session info\n\n\nsessionInfo()\n## R version 4.3.1 (2023-06-16 ucrt)\n## Platform: x86_64-w64-mingw32/x64 (64-bit)\n## Running under: Windows 11 x64 (build 22621)\n## \n## Matrix products: default\n## \n## \n## locale:\n## [1] LC_COLLATE=English_United Kingdom.utf8 \n## [2] LC_CTYPE=English_United Kingdom.utf8   \n## [3] LC_MONETARY=English_United Kingdom.utf8\n## [4] LC_NUMERIC=C                           \n## [5] LC_TIME=English_United Kingdom.utf8    \n## \n## time zone: Europe/London\n## tzcode source: internal\n## \n## attached base packages:\n## [1] stats     graphics  grDevices datasets  utils     methods   base     \n## \n## other attached packages:\n##  [1] quickdag_0.2.0    DiagrammeR_1.0.10 ggdag_0.2.10      dagitty_0.3-1    \n##  [5] lubridate_1.9.3   forcats_1.0.0     stringr_1.5.0     dplyr_1.1.3      \n##  [9] purrr_1.0.2       readr_2.1.4       tidyr_1.3.0       tibble_3.2.1     \n## [13] ggplot2_3.4.3     tidyverse_2.0.0  \n## \n## loaded via a namespace (and not attached):\n##  [1] gtable_0.3.4       xfun_0.40          htmlwidgets_1.6.2  visNetwork_2.1.2  \n##  [5] ggrepel_0.9.3      tzdb_0.4.0         vctrs_0.6.3        tools_4.3.1       \n##  [9] generics_0.1.3     curl_5.1.0         fansi_1.0.4        pkgconfig_2.0.3   \n## [13] checkmate_2.2.0    RColorBrewer_1.1-3 lifecycle_1.0.3    compiler_4.3.1    \n## [17] farver_2.1.1       munsell_0.5.0      tinytex_0.47       ggforce_0.4.1     \n## [21] graphlayouts_1.0.1 codetools_0.2-19   htmltools_0.5.6    yaml_2.3.7        \n## [25] htmlTable_2.4.1    pillar_1.9.0       MASS_7.3-60        ellipsis_0.3.2    \n## [29] viridis_0.6.4      boot_1.3-28.1      tidyselect_1.2.0   digest_0.6.33     \n## [33] stringi_1.7.12     rsvg_2.5.0         labeling_0.4.3     polyclip_1.10-6   \n## [37] fastmap_1.1.1      grid_4.3.1         colorspace_2.1-0   cli_3.6.1         \n## [41] magrittr_2.0.3     messaging_0.1.0    ggraph_2.1.0       tidygraph_1.2.3   \n## [45] utf8_1.2.3         withr_2.5.1        backports_1.4.1    scales_1.2.1      \n## [49] timechange_0.2.0   rmarkdown_2.25     igraph_1.5.1       gridExtra_2.3     \n## [53] hms_1.1.3          evaluate_0.22      knitr_1.44         V8_4.3.3          \n## [57] viridisLite_0.4.2  rlang_1.1.1        Rcpp_1.0.11        glue_1.6.2        \n## [61] tweenr_2.0.2       renv_1.0.3         DiagrammeRsvg_0.1  rstudioapi_0.15.0 \n## [65] jsonlite_1.8.7     R6_2.5.1\nquarto::quarto_version()\n## [1] '1.3.450'\ntinytex::tlmgr_version()\n## tlmgr revision 66798 (2023-04-08 02:15:21 +0200)\n## tlmgr using installation: C:/Users/tom/AppData/Roaming/TinyTeX\n## TeX Live (https://tug.org/texlive) version 2023"
  }
]